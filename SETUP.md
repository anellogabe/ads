# Setup Instructions - Cardona Case Dashboard

This guide will help you get the Wage & Hour Dashboard running with your Cardona case data.

## Prerequisites

- R (version 4.0 or higher)
- RStudio (recommended)
- Required R packages (will be installed automatically)

## Step 1: Clone/Pull the Repository

```bash
git clone <repository-url>
cd ads
# OR if already cloned:
git pull origin claude/wage-hour-dashboard-8aURz
```

## Step 2: Add Your Cardona Data Files

Place your case data files in the `data/raw/` folder:

```
data/raw/
â”œâ”€â”€ Cardona_time_data.xlsx      # Your time/punch data
â”œâ”€â”€ Cardona_pay_data.xlsx       # Your payroll data
â””â”€â”€ Cardona_employee_list.xlsx  # Employee roster (optional)
```

**Note:** The exact filenames should match what's in your `scripts/clean_data.R` file.

## Step 3: Update File Paths in clean_data.R

Open `scripts/clean_data.R` and update the file paths to match your data files:

### Line 11 - Time Data
```r
time1 <- read_excel("data/raw/Cardona_time_data.xlsx")
```

### Line ~191 - Pay Data
```r
pay1 <- read_excel("data/raw/Cardona_pay_data.xlsx")
```

### Line ~433 - Employee List (if applicable)
```r
class1 <- read_excel("data/raw/Cardona_employee_list.xlsx")
```

## Step 4: Install Required R Packages

Open R or RStudio and run:

```r
# Install required packages
install.packages(c(
  "shiny",
  "shinydashboard",
  "data.table",
  "DT",
  "here",
  "readxl",
  "lubridate",
  "openxlsx"
))
```

## Step 5: Run the Analysis Pipeline

In R or RStudio, run:

```r
source("run_analysis.R")
```

This will:
1. âœ… Clean and standardize your data
2. âœ… Run wage & hour analysis
3. âœ… Calculate violations and damages
4. âœ… Generate Analysis.csv and other outputs
5. âœ… Prepare data for the dashboard

**Expected output files:**
- `data/processed/time_processed.rds`
- `data/processed/pay_processed.rds`
- `output/Analysis.csv`
- `output/Time Shift Data.csv`

## Step 6: Launch the Dashboard

```r
shiny::runApp("dashboards/app.R")
```

The dashboard will open in your default web browser.

## Dashboard Features

The dashboard has 10 pages, each showing a section of your Analysis.csv data:

1. **Time Data Summary** - Overall time metrics
2. **Meal Period Analysis** - Meal break analysis
3. **Meal Violations >5 hrs** - Violations for shifts over 5 hours
4. **Meal Violations >6 hrs** - Violations for shifts over 6 hours
5. **Rest Periods** - Rest break analysis and violations
6. **Shift Hours Analysis** - Shift-level time analysis
7. **Rounding Analysis** - Time punch rounding patterns
8. **Pay Summary** - Payroll summary metrics
9. **Bonuses & Diffs** - Bonus and differential pay
10. **Regular Rate Groups** - RROP analysis

### Filters (Sidebar)
- **Employee ID** - Filter to a specific employee
- **Class/Job** - Filter by job classification
- **Refresh Data** - Reload after re-running analysis

## Troubleshooting

### "File not found" error
- Check that your data files are in `data/raw/`
- Verify the file paths in `scripts/clean_data.R` match exactly

### "Package not found" error
```r
# Install missing package
install.packages("package_name")
```

### "Object not found" error during analysis
- Check that your data files have the expected columns
- Review the column name mapping in `scripts/clean_data.R`

### Dashboard shows "No data available"
- Verify `output/Analysis.csv` exists
- Check that the analysis completed successfully
- Re-run `source("run_analysis.R")`

### Column name mismatches
The analysis expects these columns in your time data:
- `ID` (Employee ID)
- `Date` (Shift date)
- `In` (Punch in time)
- `Out` (Punch out time)
- `Hours` (Hours worked)
- `Code` (Pay code)

If your data uses different names, update the `standard_names` mapping in `scripts/clean_data.R` around line 20.

## Testing with Sample Data

If you want to test before adding your real data:

```r
# Create sample data for testing
source("create_sample_data.R")

# Update clean_data.R to use sample files:
# Line 11:  time1 <- read_excel("data/raw/SAMPLE_time_data.xlsx")
# Line 191: pay1 <- read_excel("data/raw/SAMPLE_pay_data.xlsx")

# Run the pipeline
source("run_analysis.R")

# Launch dashboard
shiny::runApp("dashboards/app.R")
```

## File Structure

After setup, your directory should look like this:

```
ads/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                          # Your data files (not in git)
â”‚   â”‚   â”œâ”€â”€ Cardona_time_data.xlsx
â”‚   â”‚   â””â”€â”€ Cardona_pay_data.xlsx
â”‚   â””â”€â”€ processed/                    # Generated by analysis (not in git)
â”‚       â”œâ”€â”€ time_processed.rds
â”‚       â””â”€â”€ pay_processed.rds
â”‚
â”œâ”€â”€ output/                           # Generated by analysis (not in git)
â”‚   â”œâ”€â”€ Analysis.csv
â”‚   â””â”€â”€ Time Shift Data.csv
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ clean_data.R                  # Configure your file paths here
â”‚   â”œâ”€â”€ analysis.R                    # Main analysis logic
â”‚   â”œâ”€â”€ functions.R                   # Helper functions
â”‚   â””â”€â”€ metrics_spec.csv              # Metrics configuration
â”‚
â”œâ”€â”€ dashboards/
â”‚   â””â”€â”€ app.R                         # Shiny dashboard
â”‚
â”œâ”€â”€ run_analysis.R                    # Run this to execute pipeline
â”œâ”€â”€ SETUP.md                          # This file
â”œâ”€â”€ QUICKSTART.md                     # Quick reference guide
â””â”€â”€ README.md                         # Full documentation
```

## Next Steps

1. âœ… Add your Cardona data files to `data/raw/`
2. âœ… Update file paths in `scripts/clean_data.R`
3. âœ… Run `source("run_analysis.R")`
4. âœ… Launch `shiny::runApp("dashboards/app.R")`
5. âœ… Review the dashboard and verify the data looks correct

## Need Help?

- Check `QUICKSTART.md` for quick reference
- See `README.md` for detailed documentation
- Review console output for specific error messages
- Verify your data file structure matches expected format

Happy analyzing! ðŸ“Š
